**02.RE_Script （分区挂载/还原）**

---

- **Recovery.bat**

  - ```bash
    ::不显示命令，只显示运行结果
    @Echo Off
    ::快速格式化C盘，并设置卷标为“Windows_OS”
    Format /Q /Y /V:Windows_OS C:
    ::释放 O 盘文件 xxxxx.wim 文件到 C 盘并验证文件完整性
    ImageX.exe /Apply O:\RE_Image\xxxxx.wim 1 C:\ /Verify
    ::挂载 ESP 分区脚本
    DiskPart /S Mount_ESP.txt
    ::修复C 盘系统引导
    Bcdboot C:\Windows /S Z: /F UEFI
    ::卸载 ESP 分区
    DiskPart /S Uninstall_ESP.txt
    ::换行
    Echo.
    ::按任意键退出 . . .
    Echo Press any Key to exit . . .
    Pause > nul
    ```



- **01.挂载 ESP 分区**

  - **Mount_ESP.txt** [ *DiskPart* ]

    - ```DiskPart
      ::列出磁盘
      List Disk
      ::选择磁盘 0
      Sel Disk 0
      ::列出磁盘 0 分区
      List Partition
      ::选择分区 1
      Sel Partition 1
      ::设置分区 1 盘符为 Z
      Assign Letter Z
      ::退出
      Exit
      ```

  - **Uninstall_ESP.txt** [ *DiskPart* ]

    - ```DiskPart
      ::列出磁盘
      List Disk
      ::选择磁盘 0
      Sel Disk 0
      ::列出磁盘 0 分区
      List Partition
      ::选择分区 1
      Sel Partition 1
      ::删除分区 1 盘符 Z
      Remove Letter Z
      ::退出
      Exit
      ```

---

- **02.挂载 RE 分区**

  - **Mount_ReDsk.txt** [ *DiskPart* ]

    - ```DiskPart
      ::列出磁盘
      List Disk
      ::选择磁盘 0
      Sel Disk 0
      ::列出磁盘 0 分区
      List Partition
      ::选择分区 3
      Sel Partition 3
      ::设置分区 3 盘符为 O
      Assign Letter O
      ::退出
      Exit
      ```

---

- **03.HD0 磁盘分区**

  - **Script_DelDisk.txt** [ *DiskPart* ]

    - ```DiskPart
      ::列出磁盘
      Lis Dis
      ::选择磁盘 0
      Sel Dis 0
      ::列出分区
      lis Par
      ::选择分区 1
      Sel Par 1
      ::删除选择的分区
      delete partition override
      ::选择分区 2
      Sel Par 2
      ::删除选择的分区
      delete partition override
      ::选择分区 3
      Sel Par 3
      ::删除选择的分区
      delete partition override
      ::选择分区 4
      Sel Par 4
      ::删除选择的分区
      delete partition override
      ::选择分区 5
      Sel Par 5
      ::删除选择的分区
      delete partition override
      ::选择磁盘 0
      Sel Dis 0
      ::设置磁盘格式为 GPT
      Convert GPT
      ```

  - **Script_AddDisk.txt** [ *DiskPart* ]

    - ```
      ::列出磁盘
      Lis Dis
      ::选择磁盘 0
      Sel Dis 0
      ::创建 ESP 分区，分区大小 500MB
      Create partition efi size=500
      ::快速格式化 Fat32，设置卷标为“ESP”，快速格式化
      Format Fs=Fat32 Label="ESP" Quick
      ::添加盘符为 Z
      Ass Letter Z
      ::创建 MSR 分区，分区大小 16MB
      Create Partition MSR Size=16
      ::创建 恢复 分区，分区大小 10GB
      Create Partition Primary Size=10701
      ::快速格式化 NTFS，设置卷标为“OEM Recovery”，快速格式化
      Format Fs=ntfs Label="OEM Recovery" Quick
      ::设置分区 ID 为“MS Recovery”标识
      Set ID=de94bba4-06d1-4d40-a16a-bfd50179d6ac
      ::将分区设置为隐藏分区
      attributes volume set hidden
      ::添加盘符为 O
      Ass Letter O
      ::创建 系统 分区，分区大小 120GB
      Create Partition Primary Size=123341
      ::快速格式化 NTFS，设置卷标为“Windows_OS”，快速格式化
      Format Fs=ntfs Label="Windows_OS" Quick
      ::添加盘符为 C
      Ass Letter C
      ::创建 数据 分区，分区大小 345GB
      Create Partition Primary Size=353826
      ::快速格式化 NTFS，设置卷标为“Data”，快速格式化
      format fs=ntfs label="Data" Quick
      ::添加盘符为 D
      Ass Letter D
      ```
